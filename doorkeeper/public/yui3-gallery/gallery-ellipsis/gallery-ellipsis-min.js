YUI.add("gallery-ellipsis",function(a){a.DOM.ellipsis=function(f,l){l=l||{};a.mix(l,{"ellipsis":" ...","fudge":3,"lines":1,"remember":true});var k=a.one(f),b="ellipsis-original-text",h=l.remember&&k.getData(b)||k.get("text"),i=h.length,g=i,o=a.one(document.createElement(k.get("nodeName"))),c=0.01,n=function(s,r){return Math.abs(s-r)<=c;},d=function(s,r){return s-r>=c;},p=function(s,r){return s-r<=c;},q,j,e,m;o.setStyles({"overflow":"hidden","position":"absolute","visibility":"hidden","display":"block","bottom":"-10px","right":"-10px","width":k.getComputedStyle("width"),"fontSize":k.getComputedStyle("fontSize"),"fontFamily":k.getComputedStyle("fontFamily"),"fontWeight":k.getComputedStyle("fontWeight"),"letterSpacing":k.getComputedStyle("letterSpacing"),"lineHeight":k.getComputedStyle("lineHeight")});o.set("text","some sample text");a.one("body").append(o);q=parseFloat(o.getComputedStyle("height"),10);o.setStyle("overflow","visible");j=l.lines*q;o.set("text",h);e=parseFloat(o.getComputedStyle("height"),10);if(p(e,j)&&h.length===k.get("text").length){o.remove();return;}for(;g>=1;){g=Math.floor(g/2);i+=d(e,j)?-g:+g;o.set("text",h.slice(0,i-l.ellipsis.length)+l.ellipsis);e=parseFloat(o.getComputedStyle("height"),10);if(n(e,j)||p(e,j)){m=i;}}o.remove();if(l.remember&&!k.getData(b)){k.setData(b,h);}if(h.length===(o.get("text").length-l.ellipsis.length)){k.set("text",h);}else{if("undefined"!==typeof m){k.set("text",h.slice(0,m-l.ellipsis.length-l.fudge)+l.ellipsis);}}return k;};a.Node.importMethod(a.DOM,"ellipsis");a.NodeList.importMethod(a.Node.prototype,"ellipsis");},"gallery-2011.04.06-19-44",{requires:["base","node"]});